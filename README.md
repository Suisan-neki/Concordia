# 🩺 Concordia 仕様書 ver.0.1  
### ― 圧力のない説明と理解のための院内情報共有基盤 ―  
### 同意・合意の表記揺れがあるがあんまり気にしていない
---

## 0. 概要（Abstract）

**Concordia** は、医療現場における「説明と理解」のプロセスを、  
圧力なく、誤解なく、透明に記録するための院内情報共有基盤である。  

本システムは従来の「患者同意システム（PHR-Nexus 内部モジュール）」の延長として構築され、  
単に“合意を取得する”のではなく、**合意という行為そのものの意味を問い直し、  
それを支えるための心理的・技術的構造を再設計する**ことを目的とする。  

キーワードは  
> 「Zero Pressure Architecture」  
> 「内在的脅威への設計」  
> 「Transparency with Dignity」  

である。  

---

## 1. 導入（Introduction）

当初、本開発プロジェクト（院内PHR）は「患者と医師が診療情報を共有し、  
双方が同じ情報を見ながら同意を得る」ことを目的にしていた。  

だが開発を進める中で、次の問いにぶつかった。  

> 「同意を取ることが、本当に両者の安心につながっているのか？」  
> 「“同意しました”という記録は、むしろ圧力になっていないか？」  

医師は「訴訟や誤解を避けたい」という恐れを抱き、  
患者は「その場で本音を言いづらい」という不安を抱える。  
ここにあるのは“情報非対称”ではなく、**心理的圧力の非対称**である。  

そして気づいた。  
「完全な同意」は存在しない。  
人間の理解は揺らぎ、言葉にできない不安は残る。  
だがそれでも、**「理解しようとした軌跡」だけは技術的に残すことができる。**

その考えから、**Concordia** が生まれた。  

---

## 2. 背景思想（Philosophical Context）

### 2.1 「同意」から「理解」へ  
従来の医療同意システムは、医療法的文脈における「同意の有無」を記録するものであった。  
しかし、現実の診療現場では、同意とは  
- 情報の理解  
- 判断の過程  
- 感情の変化  
が混在する複雑な行為であり、「はい／いいえ」で切り分けることはできない。  

Concordia は、同意という**行為の最小単位**を「理解行動（understanding act）」と再定義する。  
つまり、“合意（agreement）”ではなく、“理解の痕跡（trace of understanding）”を扱う。  

### 2.2 内在的脅威（Inherent Threats）
本システムが相手にする「脅威」は外部攻撃者ではない。  
脅威は内部に宿る。  

- 医師の「疑われることへの恐れ」  
- 患者の「発言をためらう不安」  
- 管理者の「監視システム化への抵抗」  

これらの**心理的防衛反応**こそが、  
医療現場の透明性を阻む“見えないセキュリティリスク”である。  

Concordia の設計は、これら**内在的脅威を中和する構造**を持つ。  

### 2.3 目的  
「誰も責めず、誰も責められない環境を技術でつくる」  
これが Concordia の基本理念である。  
セキュリティは防御のためではなく、**安心のための設計原理**と位置づける。

---

## 3. システム概要（System Overview）

### 3.1 概念構造（Conceptual Structure）

| レイヤ / 要素 | 説明 |
|----------------|------|
| **患者 ── 対話 ── 医師** | 診療室内の説明・理解・同意プロセスを双方向に接続する。 |
| **理解行動ログ** | 双方の操作・質問・閲覧行動を時系列に記録する中核データ。 |
| **Concordia Layer** | 以下4要素から構成される、理解・安心・透明性を支える基盤層。 |
| ├─ Zero Pressure Architecture (ZPA) | 圧力ゼロ設計。行動が強制ではなく選択であることを保証するUI／設計思想。 |
| ├─ Comprehension Ledger（理解台帳） | 理解行動を暗号署名付きトランザクションとして保存。 |
| ├─ Merkle Integrity Chain | 全履歴の改ざん検知を担うハッシュチェーン構造。 |
| └─ Selective Visibility（ABAC） | 役割・目的ごとに開示範囲を制御する属性ベースアクセス制御。 |

### 3.2 基本原理

| 原理 | 内容 | 技術的実装イメージ |
|--------|------|----------------|
| **Zero Pressure Architecture** | 「圧力ゼロ」の設計思想。<br>説明・署名・確認の各行為を“強制”でなく“選択”として提示。 | ステップ同意UI＋再質問機構 |
| **Comprehension Ledger** | 同意ではなく「理解行動」を暗号署名付きで記録。 | 患者・医師の確認操作／質問／再閲覧をトランザクション化 |
| **Merkle Integrity Chain** | 全記録をチェーン化し改ざんを検知。 | WORM構造＋ハッシュチェーン |
| **Selective Visibility (ABAC)** | 「見せすぎない透明性」。<br>診療・教育・監査で開示範囲を切り替える。 | 属性ベースアクセス制御＋データマスキング |

---

## 4. コア設計方針（Core Design Principles）

| 方針 | 説明 | キーワード |
|--------|--------|--------------|
| **P1. 理解の痕跡を残す** | 同意そのものではなく、理解しようとしたプロセスを記録する。 | Trace of Understanding |
| **P2. 圧力ゼロ設計** | 「押すこと」を負担にしない。1タップ署名＋再考可能UI。 | Zero Pressure |
| **P3. 不可視の信頼を強制しない** | 「信頼せよ」と命じない。技術的透明性で心理的安全を補う。 | Transparency with Dignity |
| **P4. 内在的脅威への対応** | 人間の恐れ・防衛反応をセキュリティ設計の中心に置く。 | Inherent Threat Model |
| **P5. 再学習可能性** | 記録は“証拠”ではなく“改善素材”。医療説明の質向上へ。 | Learning Feedback Loop |

---

## 5. 開発・テストガイドライン

### 5.1 テストデータ生成のベストプラクティス

**⚠️ 重要なセキュリティガイドライン**

テストデータの生成には以下のルールを厳守してください：

- ❌ **禁止**: 本番データをコピーしてテストに使用
- ❌ **禁止**: 実在データをテストに混ぜる
- ✅ **推奨**: [Fakerライブラリ](https://faker.readthedocs.io/)を使用してダミーデータを生成

**理由:**
- セキュリティリスクの回避（本番データの漏洩防止）
- プライバシー保護（実在ユーザーの個人情報保護）
- データの整合性（テスト環境と本番環境の分離）
- 再現性（テストデータの一貫性と予測可能性）

**実装例:**
```python
from faker import Faker

fake = Faker('ja_JP')  # 日本語データ生成

# 患者データの生成例
patient_data = {
    'name': fake.name(),
    'email': fake.email(),
    'phone': fake.phone_number(),
    'birth_date': fake.date_of_birth(minimum_age=18, maximum_age=100)
}
```

---

## 6. 今後の仕様セクション（予定）

| 章 | 内容 |
|------|------|
| **6. 機能仕様** | 主要機能（同意プロセス管理、理解ログ、署名・可視化UI） |
| **7. セキュリティ設計** | 暗号構造、署名方式、改ざん検知、ABACモデル |
| **8. UX設計** | ステップ型同意UI、Zero Pressure Interaction設計 |
| **9. ユースケース** | 医師・患者・監査者それぞれの利用シナリオ |
| **10. 今後の展開** | 医療AI学習・教育・地域連携への応用可能性 |

