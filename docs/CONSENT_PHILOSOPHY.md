# 合意は誰のものか（汎用フレーム）

目的: 医療に限らず「合意」を扱うあらゆる場面（研究参加、契約、教育、運用）に再利用できる、最小限で実装可能な概念枠を提示する。

---

## 1. 役割（Roles）

- 主体（Subject）: 決定が影響する当人。例: 患者、ユーザー、学習者。
- 代行者（Agent）: 主体の意思形成を支援・代行する者。例: 家族、弁護士、教師、医師。
- 管理者（Steward）: 合意の保管・運用・撤回を扱う者。例: 事務、運用担当、サーバ事業者。
- 検証者（Verifier）: 合意の存在/範囲/時点を検証する第三者。例: 監査、裁判所、別組織の窓口。

同一人物が複数の役割を兼ねる場合もある（例: 個人事業における本人=管理者）。

---

## 2. 性質（Properties）

合意が満たすべき最小要件を、実装可能な性質として整理する。

- 自発性（Voluntariness）: 圧力/強制の痕跡がない、または可視化される。
- 情報性（Informedness）: 説明が理解可能な形で提示された痕跡がある。
- 範囲性（Boundedness）: 目的・対象・期間・開示範囲が明示されている。
- 可撤回性（Revocability）: 取り消し・失効・更新が可能で、その履歴が残る。
- 検証可能性（Verifiability）: 第三者が手元で検証できる（ブラックボックスに依らない）。

上記は対立しうるため、設計では重み付け/優先順位を明示する必要がある。

---

## 3. 証跡（Traces）

合意の「存在」を直接保存するのではなく、合意に至る過程の“痕跡”を保存する。

- イベント: 説明、質問、再説明、留保、同意/不同意など。
- 連鎖: 直前のハッシュ（prev_hash）を含めたチェーンで不可逆順序を作る。
- 時刻: UTC/単調時刻。必要に応じて外部アンカー（OTS/Roughtime）。
- 署名: 必要最小限（Ed25519 等）。2者合意や代理合意は多重署名で表現。

この枠は `concordia/` の `SessionCapsule` に実装される（ドメイン非依存）。

---

## 4. 反例と限界

- “同意しない自由”が形式的にしか存在しない状況（強い非対称）では、痕跡があっても自発性は保証されない。
- 完全匿名の検証は難しい。検証と秘匿はトレードオフ。最小開示ポリシーを適用する。
- 100%の不可否認は現実的でない。合意破棄/争いの運用プロセスを別途設ける必要がある。

---

## 5. 実装へのマッピング

- 汎用: `concordia.SessionCapsule` でイベント→鎖→シール（seal）→検証（verify）。
- 医療: 診察セッションの「更新/説明/確認」をイベント化し、終了時に capsule を自動生成。
- 教育: 授業中の「提示/質問/理解確認」をイベント化し、学習者主権の痕跡を保存。

ドメイン固有の画面や業務フローは “上位アプリ” に置き、合意の痕跡は Concordia に閉じ込める。

